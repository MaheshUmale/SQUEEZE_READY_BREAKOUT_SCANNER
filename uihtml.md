This is an excellent way to document the project\! Providing a clear, technical description of the HTML Canvas functionality will ensure it can be easily understood and deployed by any code generation bot or user working in a GitHub environment.

Below is the complete description of the `SqueezeTreemap.html` file, detailing its purpose, dependencies, structure, and JavaScript functionality.

-----

## Technical Description of `SqueezeTreemap.html`

The `SqueezeTreemap.html` file is a standalone, single-page web application designed to visualize stock market scanner results (specifically, the "Squeeze" and "Momentum" states) as an interactive **Treemap**. It relies on data generated by an external Python script (e.g., `BBSqueeze.py`) saved in the local file `treemap_data.json`.

### 1\. File Summary

| Attribute | Detail |
| :--- | :--- |
| **Type** | Single-page HTML/CSS/JavaScript (Self-Contained) |
| **Dependencies (External)** | D3.js (Data Visualization), Tailwind CSS (Styling) |
| **Data Source** | `treemap_data.json` (Local file generated by Python script) |
| **Core Function** | Visualizing stock Squeeze data as a color-coded, interactive Treemap. |

### 2\. Dependencies

The page loads two external libraries via `<script>` tags in the `<head>`:

1.  **Tailwind CSS:** For all styling, responsiveness, and layout.
    ```html
    <script src="https://cdn.tailwindcss.com"></script>
    ```
2.  **D3.js (v7):** The core library used for data manipulation, hierarchical layout calculation (treemap), and SVG rendering.
    ```html
    <script src="https://d3js.org/d3.v7.min.js"></script>
    ```

### 3\. Core Functionality (JavaScript)

The primary logic is encapsulated in the `<script>` block at the end of the `<body>`.

#### A. Data Loading and Auto-Refresh

  * **`loadData()` Function:** This function is responsible for fetching the stock data from `treemap_data.json`. It appends a cache-busting timestamp (`?t=...`) to the URL to ensure the browser always loads the latest data generated by the Python script.
  * **Initial Load:** `loadData()` is called immediately on page load.
  * **Auto-Refresh:** The page sets an interval to call `loadData()` every 120,000 milliseconds (2 minutes) to automatically refresh the Treemap without a page reload, matching the assumed update frequency of the background Python scanner.

#### B. Data Processing and Treemap Layout

  * **Hierarchy Creation:** The `d3.hierarchy()` function converts the flat JSON list into a hierarchical structure, grouped by the `group` property (Bullish/Bearish/Neutral).
  * **Treemap Generation:** `d3.treemap()` is used to calculate the size and position of each rectangle based on the calculated `value` property.
      * **Sizing Metric (Heatmap Score):** The size of each leaf node (stock) is determined by the `value` field, which is calculated in the Python script as:
        $$\text{Heatmap Score} = (\text{RVOL}|5 + 1) \times \text{TotalSqueezeCount}$$
        This ensures the Treemap visualizes a blend of unusual volume activity and multi-timeframe squeeze count.
  * **Color Scale (`colorScale`):** A D3 linear scale is defined to map the **RVOL** (from 0 to 5) to a shading gradient.
      * This scale is used to determine the saturation/lightness of the base Bullish (Green) or Bearish (Red) color, emphasizing high-RVOL stocks.

#### C. SVG Rendering and Interactivity

  * **Containers:** The function generates two main groups (`g` elements): `cell` (for each stock box) and `groupCell` (for the Bullish/Bearish headers).
  * **Stock Rectangles (`cell`):**
      * **Fill Color:** Determined dynamically using `colorScale(d.data.rvol)`. If the group is 'Bullish', the scale maps to a Green color range; if 'Bearish', it maps to a Red color range.
      * **On-Click Event:** An event listener is attached to each stock box:
        ```javascript
        .on("click", (event, d) => window.open(d.data.url, "_blank"))
        ```
        This opens the stock's pre-encoded TradingView chart URL in a new browser tab.
  * **Tooltips:** A tooltip system is implemented to display detailed data on hover (Ticker, Squeeze Count, RVOL, and Heatmap Score).

### 4\. Styling (Tailwind CSS)

Tailwind is used for the header layout, fonts, margins, and general responsiveness. All visualization-specific styling (rectangle fill, hover effects) is handled dynamically via D3's SVG attributes.
